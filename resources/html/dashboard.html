{% extends "base.html" %}

{% block css %}
{%style "/css/driverView.css" %}
{% endblock css %}

{% block page %}
{% if vehicle %}
<div class="row g-0 my-4" style="gap: 2rem">
    <div class="col-12  col-md-4 col-lg-3 d-flex flex-column">
        <h4 class="p-3 bg-primary col-12 text-light rounded">My vehicle</h4>
        <ul class="list-group list-group-flush col-12">
            <li class="list-group-item d-flex justify-content-between">
                <span>Plate</span>
                <strong>{{vehicle.number_plate}}</strong>
            </li>
            <li class="list-group-item d-flex justify-content-between">
                <span>Color</span>
                <strong>{{vehicle.color}}</strong>
            </li>
            <li class="list-group-item d-flex justify-content-between">
                <span>Model</span>
                <strong>{{vehicle.model}}</strong>
            </li>
        </ul>

        <div class="card p-0 border-0 mt-4">
            <div class="card-body">
                <h4>Status</h4>
                <hr>
                {% if accepted_order %}
                <form method="post" action="/end-ride">
                    <h5>Currently occupied</h5>
                    {% csrf-field %}
                    <button class="btn-danger btn">END RIDE</button>
                </form>
                {%else%}

                <form method="post" action="/update-vehicle-availability" class="row g-0">
                    <div class="col-12">
                        {% csrf-field %}
                        <input type="hidden" name="vehicle" value="{{vehicle.id}}">
                        <h5 class="mb-0">Availability</h5><br>
                        <label> unavailable&nbsp;&nbsp;
                            <input name="availability" value="unavailable" {% ifequal vehicle.availability "unavailable"
                                %}checked{% endifequal %} type="radio">
                        </label>
                        |
                        <label>available&nbsp;<input name="availability" value="available" {% ifequal
                                vehicle.availability "available" %}checked{% endifequal %} type="radio">
                        </label>
                        <h5 class="mb-0 mt-4">Rate (per kilometer)</h5><br>
                        <label>Rate &nbsp;<input type="number" value="{{vehicle.rate}}" name="rate" min="0"></label>
                    </div>

                    <input type="submit" class="btn btn-info col-12 mt-3" value="Upate Status">

                </form>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="col">
        <div class="bg-{% if accepted_order %}info{%else%}primary{% endif %} text-light p-2 mb-2 rounded">
            {% if accepted_order %}
            <h4>My accepted order</h4>
            <ul class="list-group list-group-flush">
                <li class="list-group-item">Name: {{accepted_order.first_name}} {{accepted_order.last_name}}</li>
            </ul>
            {%else%}

            <h4>My requests</h4>
            <!-- Hover added -->
            <div class="list-group">
                {% for o in orders %}
                <div class="list-group-item">
                    <form action="/accept-order" method="post" class="d-flex justify-content-between">
                        <span>{{o.first_name}} {{o.last_name}}</span>
                        {% csrf-field %}
                        <input type="hidden" name="order" value="{{o.id}}">
                        <button class="btn btn-danger">Accept</btn>
                    </form>
                </div>
                {%empty%}
                <a href="#" class="list-group-item">No orders</a>
                {% endfor %}
            </div>
            {% endif %}
        </div>



    </div>
</div>
{%else%}
{% include "partials/_add_vehicle.html" %}
{% endif %}

{% endblock page %}